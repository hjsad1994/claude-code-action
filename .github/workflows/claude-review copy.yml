  name: Claude Code Assistant

  on:
    issue_comment:
      types: [created]
    pull_request_review_comment:
      types: [created]
    pull_request:
      types: [opened, synchronize, ready_for_review]

  permissions:
    contents: write
    pull-requests: write
    issues: write
    id-token: write

  jobs:
    claude:
      runs-on: ubuntu-latest
      if: |
        github.event_name == 'pull_request' ||
        contains(github.event.comment.body, '/claude')

      steps:
        - name: Checkout repository
          uses: actions/checkout@v4
          with:
            fetch-depth: 0

        - name: Run Claude Code
          uses: hjsad1994/claude-code-action@main
          with:
            custom_api_base_url: ${{ secrets.CUSTOM_API_BASE_URL }}
            custom_api_key: ${{ secrets.CUSTOM_API_KEY }}
            trigger_phrase: "/claude"
            claude_args: |
              --model "claude-opus-4-5-20251101"